# Эмулятор оболочки

## Общее описание
Этот проект реализует упрощённый эмулятор Unix-подобной командной оболочки на Python.  

Основные возможности:  
- Работа с виртуальной файловой системой (VFS), которая загружается из CSV или создаётся по умолчанию в памяти.  
- Поддержка базовых команд:  
  - `ls` — вывод содержимого текущего каталога  
  - `cd` — смена текущего каталога  
  - `echo` — вывод текста и значений переменных окружения  
  - `head` — вывод первых 10 строк файла из VFS  
  - `whoami` — отображение текущего пользователя  
  - `uname` — отображение операционной системы  
  - `chmod` — изменение прав доступа файлов и каталогов в VFS  
  - `exit` — завершение работы оболочки  
- Два режима работы:  
  - **Интерактивный** — ввод команд вручную  
  - **Скриптовый** — выполнение последовательности команд из файла  

---

## Описание функций и настроек

### Классы
- **VFSNode** — узел виртуальной файловой системы (файл или каталог).  
  - `name` — имя  
  - `type` — `"dir"` или `"file"`  
  - `mode` — строка с правами (например, `"755"`)  
  - `content` — содержимое файла (в `bytes`)  
  - `children` — словарь дочерних узлов  

- **VFS** — виртуальная файловая система.  
  - `root` — корень `/`  
  - `cwd` — текущий узел  
  - `cwd_path` — строка пути  
  - Методы:  
    - `load_from_csv(path)` — загрузка структуры из CSV  
    - `ensure_default()` — создание базовой структуры (если CSV не задан)  
    - `ls()` — список элементов каталога  
    - `cd(path)` — смена каталога  
    - `chmod(mode, path)` — изменение прав доступа  

### Функции
- `build_prompt(vfs)` — строит приглашение командной строки вида `user@host:/path$`  
- `expand_vars_preserving_quotes(s, env)` — разворачивает переменные окружения с учётом кавычек  
- `parse_command(line, env)` — парсинг строки в список аргументов (аналог `shlex`)  
- `handle_command(tokens, vfs)` — обработка команд  
- `run_interactive(env, vfs)` — запуск интерактивного режима  
- `run_script(path, env, vfs)` — выполнение команд из скрипта  
- `main()` — точка входа: настройка аргументов, запуск нужного режима  

### Аргументы командной строки
- `--vfs <путь>` — CSV-файл с описанием виртуальной файловой системы  
- `--script <путь>` — файл скрипта с командами для выполнения  

---

## Команды для сборки и запуска проекта

Для запуска проекта необходимо:  
1. Подготовить CSV-файл с описанием виртуальной файловой системы (VFS).  
2. Запустить эмулятор в одном из режимов:  
   - **Интерактивный режим** — без параметров, открывается командная оболочка  
   - **Скриптовый режим** — запуск с указанием файла сценария, команды выполняются построчно  
3. При необходимости можно указать свой CSV-файл для инициализации VFS.  

Поддерживаемые параметры:  
- `--vfs <путь>` — путь к CSV-файлу виртуальной файловой системы  
- `--script <путь>` — путь к скрипту с командами для автоматического выполнения  

---

## Примеры использования
- Запуск эмулятора в интерактивном режиме с дефолтной VFS  
- Запуск эмулятора с загрузкой структуры VFS из указанного CSV-файла  
- Автоматическое выполнение набора команд из сценария при старте  
- Проверка работы встроенных команд: `ls`, `cd`, `head`, `chmod`, `echo`, `whoami`, `uname`, `exit`  
- Использование вложенных каталогов и файлов с содержимым, сохранённым в формате base64  
